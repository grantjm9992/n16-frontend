"use strict";(self.webpackChunknobleui_angular=self.webpackChunknobleui_angular||[]).push([[213],{9632:(y,u,i)=>{i.d(u,{n:()=>d});var h=i(5384),l=i(4650);let d=(()=>{class e extends h.s{getAll(c=""){return this.get(`${this.getUrl()}?${c}`)}find(c){return this.get(`${this.getUrl()}/${c}`)}create(c){return this.post(`${this.getUrl()}`,c)}update(c,m){return this.post(`${this.getUrl()}/${c}`,m)}remove(c){return this.delete(`${this.getUrl()}/${c}`)}}return e.\u0275fac=function(){let g;return function(m){return(g||(g=l.n5z(e)))(m||e)}}(),e.\u0275prov=l.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},3213:(y,u,i)=>{i.r(u),i.d(u,{TeachingHoursModule:()=>$});var h=i(6895),l=i(9585),d=i(9061),e=i(4650),g=i(3116),c=i(9632);let m=(()=>{class r extends c.n{getUrl(){return"/teaching-hours"}}return r.\u0275fac=function(){let o;return function(n){return(o||(o=e.n5z(r)))(n||r)}}(),r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var x=i(8386),D=i(5954),C=i(40),f=i(3599),p=i(433),T=i(9177);function b(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"span",27),e.NdJ("mouseenter",function(){const s=e.CHM(t).$implicit,_=e.oxw();return e.KtG(_.hoveredDate=s)})("mouseleave",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.hoveredDate=null)}),e._uU(1),e.qZA()}if(2&r){const t=o.$implicit,n=o.focused,a=e.oxw();e.ekj("focused",n)("range",a.isRange(t))("faded",a.isHovered(t)||a.isInside(t)),e.xp6(1),e.hij(" ",t.day," ")}}function A(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",14)(1,"div",7)(2,"div",15)(3,"h6",9),e._uU(4,"Filter by company"),e.qZA(),e.TgZ(5,"ng-select",16),e.NdJ("change",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.filterResources())})("ngModelChange",function(a){e.CHM(t);const s=e.oxw();return e.KtG(s.selectedSimpleItem=a)}),e.qZA()()()()}if(2&r){const t=e.oxw();e.xp6(5),e.Q6J("items",t.simpleItems)("searchable",!0)("ngModel",t.selectedSimpleItem)}}function H(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",14)(1,"div",7)(2,"div",15)(3,"h6",9),e._uU(4,"Filter by type of class"),e.qZA(),e.TgZ(5,"ng-select",28),e.NdJ("change",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.filterRows())})("ngModelChange",function(a){e.CHM(t);const s=e.oxw();return e.KtG(s.eventType=a)}),e.qZA()()()()}if(2&r){const t=e.oxw();e.xp6(5),e.Q6J("items",t.eventTypes)("searchable",!0)("ngModel",t.eventType)}}function M(r,o){if(1&r){const t=e.EpF();e.TgZ(0,"div",14)(1,"div",7)(2,"div",15)(3,"h6",9),e._uU(4,"Filter by department"),e.qZA(),e.TgZ(5,"ng-select",28),e.NdJ("change",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.filterRows())})("ngModelChange",function(a){e.CHM(t);const s=e.oxw();return e.KtG(s.department=a)}),e.qZA()()()()}if(2&r){const t=e.oxw();e.xp6(5),e.Q6J("items",t.departments)("searchable",!0)("ngModel",t.department)}}function I(r,o){1&r&&e._UZ(0,"ngx-datatable-column",29)}function S(r,o){1&r&&e._UZ(0,"ngx-datatable-column",30)}function Z(r,o){1&r&&e._UZ(0,"ngx-datatable-column",31)}let U=(()=>{class r{constructor(t,n,a,s,_,v){this.eventTypeApiService=t,this.teacherApiService=n,this.userService=a,this.companyApiService=s,this.departmentApiService=_,this.maxDate=null,this.rows=[],this.filteredRows=[],this.loadingIndicator=!0,this.reorderable=!0,this.ColumnMode=l.hq,this.selectedSimpleItem="",this.groupByItems=[{id:"teacher_and_event_type",name:"Teacher and event type"},{id:"teacher_and_department",name:"Teacher and department"},{id:"teacher",name:"Teacher"},{id:"department",name:"Department"}],this.groupByItem="teacher",this.hoveredDate=null,this.toDate=null,this.eventTypes=[],this.departments=[],this.filterString="",this.toDate=v.getToday(),this.fromDate=v.getNext(v.getToday(),"d",-6)}onDateSelection(t){this.maxDate=null,this.fromDate||this.toDate?this.fromDate&&!this.toDate&&t.after(this.fromDate)?this.toDate=t:(this.toDate=null,this.fromDate=t,this.setMaxDate()):(this.fromDate=t,this.setMaxDate())}setMaxDate(){let t=new Date(this.fromDate.year,this.fromDate.month,this.fromDate.day);t.setDate(t.getDate()+31),this.maxDate=new d.qj(t.getFullYear(),t.getMonth(),t.getDate())}isHovered(t){return this.fromDate&&!this.toDate&&this.hoveredDate&&t.after(this.fromDate)&&t.before(this.hoveredDate)}isInside(t){return this.toDate&&t.after(this.fromDate)&&t.before(this.toDate)}isRange(t){return t.equals(this.fromDate)||this.toDate&&t.equals(this.toDate)||this.isInside(t)||this.isHovered(t)}ngOnInit(){this.activeUser=this.userService.getUser(),this.companyApiService.getCompanies().subscribe(t=>{this.simpleItems=t.data}),this.eventTypeApiService.getAll().subscribe(t=>{this.eventTypes=t.data}),this.departmentApiService.getAll().subscribe(t=>{this.departments=t.data})}filter(t){this.filterString=t.target.value.toLowerCase(),this.filterRows()}filterRows(){this.rows=this.filteredRows.filter(t=>{let n=!0;this.eventType&&(n=this.eventType===t.event_type);let a=!0;return this.department&&(a=this.department===t.department),-1!==this.getString(t).indexOf(this.filterString)&&n&&a})}getString(t){let n=`${t.name.toString().toLowerCase()} `;return t.surname&&(n+=`${t.surname.toString().toLowerCase()}`),n}getDateString(t){return`${t.year}-${this.pad(t.month)}-${this.pad(t.day)}`}pad(t,n=2){let a=t+"";for(;a.length<n;)a="0"+a;return a}filterResources(){"teacher_and_event_type"===this.groupByItem&&(this.eventType=null),this.loadingIndicator=!0;let t=this.getDateString(this.fromDate),n=this.getDateString(this.toDate);this.teacherApiService.getAll(`start_date=${t}&end_date=${n}&group_by=${this.groupByItem}&company_id=${this.selectedSimpleItem}`).subscribe(a=>{this.rows=a,this.filteredRows=a,this.loadingIndicator=!1})}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(g.L),e.Y36(m),e.Y36(x.K),e.Y36(D.s),e.Y36(C.N),e.Y36(d.vL))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-teaching-hours"]],decls:45,vars:17,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","."],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"col-md-12","grid-margin","stretch-card"],[1,"card"],[1,"card-body","text-center"],[1,"card-title"],["outsideDays","hidden",1,"range-selection",3,"displayMonths","dayTemplate","maxDate","dateSelect"],["dp",""],["t",""],["class","col-md-6 grid-margin stretch-card",4,"ngIf"],[1,"col-md-6","grid-margin","stretch-card"],[1,"card-body"],["bindLabel","name","bindValue","id",3,"items","searchable","ngModel","change","ngModelChange"],["type","text",1,"form-control","wd-150","w-100",3,"keyup"],[1,"col-md-12","stretch-card"],[1,"card-title","d-flex","justify-content-between"],[1,"table-responsive"],["rowHeight","auto",1,"bootstrap",3,"rows","loadingIndicator","columnMode","footerHeight","limit"],["name","Name","prop","name"],["name","Surname","prop","surname",4,"ngIf"],["name","Event type","prop","event_type",4,"ngIf"],["name","Department","prop","department",4,"ngIf"],["name","Time","prop","time"],[1,"custom-day",3,"mouseenter","mouseleave"],["bindLabel","name","bindValue","name",3,"items","searchable","ngModel","change","ngModelChange"],["name","Surname","prop","surname"],["name","Event type","prop","event_type"],["name","Department","prop","department"]],template:function(t,n){if(1&t&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._uU(4,"Hours"),e.qZA()(),e.TgZ(5,"li",4),e._uU(6,"List"),e.qZA()()(),e.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"h6",9),e._uU(12,"Date range"),e.qZA(),e.TgZ(13,"ngb-datepicker",10,11),e.NdJ("dateSelect",function(s){return n.onDateSelection(s)}),e.qZA(),e.YNc(15,b,2,7,"ng-template",null,12,e.W1O),e.qZA()()(),e.YNc(17,A,6,3,"div",13),e.TgZ(18,"div",14)(19,"div",7)(20,"div",15)(21,"h6",9),e._uU(22,"Group by"),e.qZA(),e.TgZ(23,"ng-select",16),e.NdJ("change",function(){return n.filterResources()})("ngModelChange",function(s){return n.groupByItem=s}),e.qZA()()()(),e.TgZ(24,"div",14)(25,"div",7)(26,"div",15)(27,"h6",9),e._uU(28,"Filter"),e.qZA(),e.TgZ(29,"input",17),e.NdJ("keyup",function(s){return n.filter(s)}),e.qZA()()()(),e.YNc(30,H,6,3,"div",13),e.YNc(31,M,6,3,"div",13),e.qZA(),e.TgZ(32,"div",5)(33,"div",18)(34,"div",7)(35,"div",15)(36,"h6",19),e._uU(37," Teaching hours "),e.qZA(),e.TgZ(38,"div",20)(39,"ngx-datatable",21),e._UZ(40,"ngx-datatable-column",22),e.YNc(41,I,1,0,"ngx-datatable-column",23),e.YNc(42,S,1,0,"ngx-datatable-column",24),e.YNc(43,Z,1,0,"ngx-datatable-column",25),e._UZ(44,"ngx-datatable-column",26),e.qZA()()()()()()),2&t){const a=e.MAs(16);e.xp6(13),e.Q6J("displayMonths",2)("dayTemplate",a)("maxDate",n.maxDate),e.xp6(4),e.Q6J("ngIf","super_admin"==n.activeUser.user_role||"admin"),e.xp6(6),e.Q6J("items",n.groupByItems)("searchable",!0)("ngModel",n.groupByItem),e.xp6(7),e.Q6J("ngIf","teacher_and_event_type"===n.groupByItem),e.xp6(1),e.Q6J("ngIf","teacher_and_department"===n.groupByItem),e.xp6(8),e.Q6J("rows",n.rows)("loadingIndicator",n.loadingIndicator)("columnMode",n.ColumnMode.force)("footerHeight",50)("limit",10),e.xp6(2),e.Q6J("ngIf","teacher_and_event_type"===n.groupByItem||"teacher"),e.xp6(1),e.Q6J("ngIf","teacher_and_event_type"===n.groupByItem),e.xp6(1),e.Q6J("ngIf","teacher_and_department"===n.groupByItem)}},dependencies:[h.O5,f.yS,l.nE,l.UC,p.JJ,p.On,d.VL,T.w9]}),r})();var w=i(2851);const J=[{path:"",component:U}];let $=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[h.ez,f.Bz.forChild(J),l.xD,p.u5,p.UX,w.e4,d.M,T.A0]}),r})()}}]);