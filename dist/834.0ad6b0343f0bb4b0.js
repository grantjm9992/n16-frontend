"use strict";(self.webpackChunknobleui_angular=self.webpackChunknobleui_angular||[]).push([[834],{9632:(y,h,s)=>{s.d(h,{n:()=>e});var m=s(5384),u=s(4650);let e=(()=>{class c extends m.s{getAll(r=""){return this.get(`${this.getUrl()}?${r}`)}find(r){return this.get(`${this.getUrl()}/${r}`)}create(r){return this.post(`${this.getUrl()}`,r)}update(r,_){return this.post(`${this.getUrl()}/${r}`,_)}remove(r){return this.delete(`${this.getUrl()}/${r}`)}}return c.\u0275fac=function(){let p;return function(_){return(p||(p=u.n5z(c)))(_||c)}}(),c.\u0275prov=u.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},5954:(y,h,s)=>{s.d(h,{s:()=>e});var m=s(5384),u=s(4650);let e=(()=>{class c extends m.s{getCompanies(){return this.get("/companies")}getCompany(r){return this.get(`/companies/${r}`)}updateCompany(r,_){return this.post(`/companies/${r}`,_)}createCompany(r){return this.post("/companies",r)}}return c.\u0275fac=function(){let p;return function(_){return(p||(p=u.n5z(c)))(_||c)}}(),c.\u0275prov=u.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},5902:(y,h,s)=>{s.d(h,{O:()=>e});var m=s(5384),u=s(4650);let e=(()=>{class c extends m.s{getTeachers(r=""){return this.get(`/teacher?company_id=${r}`)}getTeacher(r){return this.get(`/teacher/${r}`)}updateTeacher(r,_){return this.post(`/teacher/${r}`,_)}createTeacher(r){return this.post("/teacher",r)}deleteTeacher(r,_){return this.delete(`/teacher/${r}`)}}return c.\u0275fac=function(){let p;return function(_){return(p||(p=u.n5z(c)))(_||c)}}(),c.\u0275prov=u.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},7834:(y,h,s)=>{s.r(h),s.d(h,{HolidayModule:()=>R});var m=s(6895),u=s(9585),e=s(4650),c=s(9632);let p=(()=>{class n extends c.n{getUrl(){return"/holidays"}accept(t){return this.get(`${this.getUrl()}/${t}/accept`)}reject(t){return this.get(`${this.getUrl()}/${t}/reject`)}revoke(t){return this.get(`${this.getUrl()}/${t}/revoke`)}}return n.\u0275fac=function(){let o;return function(a){return(o||(o=e.n5z(n)))(a||n)}}(),n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var r=s(3599),_=s(5954),v=s(8386),b=s(9061);function T(n,o){if(1&n&&e._uU(0),2&n){const t=o.value;e.AsE(" ",t.name," ",t.surname," ")}}function A(n,o){1&n&&(e.TgZ(0,"ngx-datatable-column",23),e.YNc(1,T,1,2,"ng-template",20),e.qZA())}function x(n,o){if(1&n&&e._uU(0),2&n){const t=o.row,a=e.oxw();e.hij(" ",a.getAbsenceType(t.absence_type)," ")}}function C(n,o){1&n&&(e.TgZ(0,"button",24),e._UZ(1,"i",25),e.qZA()),2&n&&e.s9C("ngbPopover",o.row.notes)}function Z(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",28),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().row,l=e.oxw(2);return e.KtG(l.accept(i.id))}),e._uU(1," Accept "),e.qZA()}}function S(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",28),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().row,l=e.oxw(2);return e.KtG(l.reject(i.id))}),e._uU(1," Reject "),e.qZA()}}function U(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",28),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().row,l=e.oxw(2);return e.KtG(l.revoke(i.id))}),e._uU(1," Revoke "),e.qZA()}}function w(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",28),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().row,l=e.oxw(2);return e.KtG(l.onRowClicked(i.id))}),e._uU(1," Edit "),e.qZA()}}function H(n,o){if(1&n&&(e.YNc(0,Z,2,0,"button",27),e.YNc(1,S,2,0,"button",27),e.YNc(2,U,2,0,"button",27),e.YNc(3,w,2,0,"button",27)),2&n){const t=o.row;e.Q6J("ngIf","accepted"!==t.status),e.xp6(1),e.Q6J("ngIf","pending"===t.status),e.xp6(1),e.Q6J("ngIf","accepted"===t.status),e.xp6(1),e.Q6J("ngIf","accepted"!==t.status)}}function k(n,o){1&n&&(e.TgZ(0,"ngx-datatable-column",26),e.YNc(1,H,4,4,"ng-template",20),e.qZA()),2&n&&e.Q6J("sortable",!1)}let E=(()=>{class n{constructor(t,a,i,l,g){this.holidayApiService=t,this.router=a,this.activatedRoute=i,this.companyApiService=l,this.userService=g,this.filteredRows=[],this.rows=[],this.loadingIndicator=!0,this.reorderable=!0,this.ColumnMode=u.hq,this.absenceTypes=[{id:"holiday",name:"Holiday"},{id:"short_term_medical_leave",name:"Short term medical leave"},{id:"short_term_medical_leave",name:"Short term medical leave"},{id:"work_absence",name:"Work absence"},{id:"unjustified",name:"Unjustified"}]}ngOnInit(){this.user=this.userService.getUser(),this.loadData()}loadData(){this.loadingIndicator=!0,this.holidayApiService.getAll().subscribe(t=>{this.rows=t.data,this.filteredRows=t.data,this.loadingIndicator=!1})}onSelect(t){console.log(t)}accept(t){this.holidayApiService.accept(t).subscribe(a=>{this.loadData()})}reject(t){this.holidayApiService.reject(t).subscribe(a=>{this.loadData()})}revoke(t){this.holidayApiService.revoke(t).subscribe(a=>{this.loadData()})}filter(t){let a=t.target.value.toLowerCase();this.rows=this.filteredRows.filter(i=>-1!==this.getString(i).indexOf(a))}getString(t){let a="";return t.teacher&&(a+=`${t.teacher.name.toString().toLowerCase()} `,a+=`${t.teacher.surname.toString().toLowerCase()}`),a}onRowClicked(t){this.router.navigate([t],{relativeTo:this.activatedRoute})}getAbsenceType(t){let a=this.absenceTypes.filter(i=>i.id===t);return 0===a.length?t:a[0].name}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(p),e.Y36(r.F0),e.Y36(r.gz),e.Y36(_.s),e.Y36(v.K))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-holiday"]],decls:29,vars:7,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","."],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"col-md-12","stretch-card"],[1,"card"],[1,"card-body"],[1,"card-title","d-flex","justify-content-between"],["routerLink","new","tabindex","-1","role","button",1,"btn","btn-primary"],[1,"col-12"],["type","text",1,"form-control","wd-150",3,"keyup"],[1,"table-responsive"],["rowHeight","auto",1,"bootstrap",3,"rows","loadingIndicator","columnMode","footerHeight","limit"],["name","Teacher","prop","teacher",4,"ngIf"],["name","Date start","prop","start_date"],["name","Date end","prop","end_date"],["name","Status","prop","status"],["name","Absence type","prop","absence_type"],["ngx-datatable-cell-template",""],["name","Information"],["name","Actions","prop","id",3,"sortable",4,"ngIf"],["name","Teacher","prop","teacher"],["type","button","placement","start",1,"btn","btn-primary",3,"ngbPopover"],[1,"feather","icon-info"],["name","Actions","prop","id",3,"sortable"],["class","btn btn-dark mx-1 mb-1",3,"click",4,"ngIf"],[1,"btn","btn-dark","mx-1","mb-1",3,"click"]],template:function(t,a){1&t&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._uU(4,"Holidays"),e.qZA()(),e.TgZ(5,"li",4),e._uU(6,"List"),e.qZA()()(),e.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"h6",9),e._uU(12," Holiday requests "),e.TgZ(13,"a",10),e._uU(14,"New"),e.qZA()(),e.TgZ(15,"div",5)(16,"div",11)(17,"input",12),e.NdJ("keyup",function(l){return a.filter(l)}),e.qZA()()(),e.TgZ(18,"div",13)(19,"ngx-datatable",14),e.YNc(20,A,2,0,"ngx-datatable-column",15),e._UZ(21,"ngx-datatable-column",16)(22,"ngx-datatable-column",17)(23,"ngx-datatable-column",18),e.TgZ(24,"ngx-datatable-column",19),e.YNc(25,x,1,1,"ng-template",20),e.qZA(),e.TgZ(26,"ngx-datatable-column",21),e.YNc(27,C,2,1,"ng-template",20),e.qZA(),e.YNc(28,k,2,1,"ngx-datatable-column",22),e.qZA()()()()()()),2&t&&(e.xp6(19),e.Q6J("rows",a.rows)("loadingIndicator",a.loadingIndicator)("columnMode",a.ColumnMode.force)("footerHeight",50)("limit",10),e.xp6(1),e.Q6J("ngIf","teacher"!==a.user.user_role),e.xp6(8),e.Q6J("ngIf","teacher"!==a.user.user_role))},dependencies:[m.O5,r.yS,u.nE,u.UC,u.vq,b.o8]}),n})();var d=s(433),I=s(5902),N=s(9646);let Y=(()=>{class n{}return n.absenceTypes=[{id:"holiday",name:"Holiday"},{id:"short_term_medical_leave",name:"Short term medical leave"},{id:"short_term_medical_leave",name:"Short term medical leave"},{id:"work_absence",name:"Work absence"},{id:"unjustified",name:"Unjustified"},{id:"other",name:"Other"}],n})(),D=(()=>{class n{get(){return(0,N.of)(Y.absenceTypes)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var f=s(9177);function M(n,o){if(1&n&&e._uU(0),2&n){const t=o.item,a=e.oxw(2);e.hij(" ",a.getUser(t)," ")}}function $(n,o){if(1&n&&(e.TgZ(0,"div",12)(1,"label",13),e._uU(2,"Teacher"),e.qZA(),e.TgZ(3,"ng-select",25),e.YNc(4,M,1,1,"ng-template",26),e.qZA()()),2&n){const t=e.oxw();e.xp6(3),e.Q6J("items",t.teachers)("searchFn",t.customSearchFn)}}function F(n,o){1&n&&e._UZ(0,"input",29)}function J(n,o){if(1&n&&(e.TgZ(0,"div",12)(1,"label",13),e._uU(2,"Absence type"),e.qZA(),e._UZ(3,"ng-select",27),e.YNc(4,F,1,0,"input",28),e.qZA()),2&n){const t=e.oxw();let a;e.xp6(3),e.Q6J("items",t.absenceTypes),e.xp6(1),e.Q6J("ngIf","other"===(null==(a=t.form.get("absence_type"))?null:a.value))}}function O(n,o){if(1&n&&(e.TgZ(0,"p",30),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Oqu(t)}}let q=(()=>{class n{constructor(t,a,i,l,g,j,B,K){this.userService=t,this.teacherApiService=a,this.holidayApiService=i,this.formBuilder=l,this.activatedRoute=g,this.router=j,this.datePipe=B,this.absenceTypesService=K,this.absenceType="",this.teachers=[],this.error=[]}ngOnInit(){this.absenceType="",this.absenceTypesService.get().subscribe(t=>{this.absenceTypes=t}),this.activeUser=this.userService.getUser(),this.teacherApiService.getTeachers().subscribe(t=>{this.teachers=t.data}),this.id=this.activatedRoute.snapshot.paramMap.get("id"),this.form=this.formBuilder.group("teacher"===this.activeUser.user_role?{start_date:["",d.kI.required],end_date:["",d.kI.required],notes:[""]}:{teacher_id:[null,d.kI.required],start_date:["",d.kI.required],end_date:["",d.kI.required],absence_type:["holiday",d.kI.required],other_absence_type:"",notes:[""]}),null!==this.id&&"new"!==this.id&&this.holidayApiService.find(this.id).subscribe(t=>{this.holiday=t.data,this.holiday.absence_type.indexOf("other:")>-1&&(this.holiday.other_absence_type=this.holiday.absence_type.slice(7,this.holiday.absence_type.length),this.holiday.absence_type="other"),this.form.patchValue(t.data),console.log(this.holiday.start_date),this.form.patchValue({start_date:this.stringToDateObject(this.holiday.start_date),end_date:this.stringToDateObject(this.holiday.end_date)})})}onSubmit(){this.error=[];let t=this.form.value;t.start_date=this.getDateString(t.start_date),t.end_date=this.getDateString(t.end_date),"other"===t.absence_type&&(t.absence_type=`${t.absence_type}: ${t.other_absence_type}`),"new"===this.id?this.holidayApiService.create(t).subscribe(a=>{this.router.navigate(["/holiday"])},a=>{if(a.errors)for(let i in a.errors)a.errors[i].forEach(l=>{this.error.push(l)});else this.error.push(a.message)}):this.holidayApiService.update(this.id,t).subscribe(a=>{this.router.navigate(["/holiday"])},a=>{if(a.errors)for(let i in a.errors)a.errors[i].forEach(l=>{this.error.push(l)});else this.error.push(a.message)})}getUser(t){return t.name+" "+t.surname}getDateString(t){return`${t.year}-${this.pad(t.month)}-${this.pad(t.day)}`}pad(t,a=2){let i=t+"";for(;i.length<a;)i="0"+i;return i}customSearchFn(t,a){return t=t.toLocaleLowerCase(),a.name.toLocaleLowerCase().indexOf(t)>-1||a.surname.toLocaleLowerCase().indexOf(t)>-1}stringToDateObject(t){return{year:Number(this.datePipe.transform(t,"yyyy")),month:Number(this.datePipe.transform(t,"MM")),day:Number(this.datePipe.transform(t,"dd"))}}addAbsenceType(t){}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(v.K),e.Y36(I.O),e.Y36(p),e.Y36(d.qu),e.Y36(r.gz),e.Y36(r.F0),e.Y36(m.uU),e.Y36(D))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-edit"]],decls:41,vars:4,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","../"],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"col-md-6","grid-margin","stretch-card"],[1,"card"],[1,"card-body"],[1,"card-title"],[1,"forms-sample",3,"formGroup","ngSubmit"],["class","mb-3",4,"ngIf"],[1,"mb-3"],[1,"form-label"],[1,"input-group"],["placeholder","yyyy-mm-dd","formControlName","start_date","ngbDatepicker","",1,"form-control"],["start_date","ngbDatepicker"],["type","button",1,"input-group-text",3,"click"],[1,"feather","icon-calendar","icon-md","text-muted"],["placeholder","yyyy-mm-dd","formControlName","end_date","ngbDatepicker","",1,"form-control"],["end_date","ngbDatepicker"],["id","notes","formControlName","notes","rows","5",1,"form-control"],["type","submit",1,"btn","btn-primary","me-2"],["routerLink","../",1,"btn","btn-secondary","me-2"],["class","text-danger mt-1",4,"ngFor","ngForOf"],["bindValue","id","formControlName","teacher_id",3,"items","searchFn"],["ng-option-tmp","","ng-label-tmp",""],["bindLabel","name","bindValue","id","formControlName","absence_type",3,"items"],["type","text","class","form-control mt-2 ","formControlName","other_absence_type",4,"ngIf"],["type","text","formControlName","other_absence_type",1,"form-control","mt-2"],[1,"text-danger","mt-1"]],template:function(t,a){if(1&t){const i=e.EpF();e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._uU(4,"Holidays"),e.qZA()(),e.TgZ(5,"li",4),e._uU(6,"New request"),e.qZA()()(),e.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"h6",9),e._uU(12,"Holiday request"),e.qZA(),e.TgZ(13,"form",10),e.NdJ("ngSubmit",function(){return a.onSubmit()}),e.YNc(14,$,5,2,"div",11),e.YNc(15,J,5,2,"div",11),e.TgZ(16,"div",12)(17,"label",13),e._uU(18,"From"),e.qZA(),e.TgZ(19,"div",14),e._UZ(20,"input",15,16),e.TgZ(22,"button",17),e.NdJ("click",function(){e.CHM(i);const g=e.MAs(21);return e.KtG(g.toggle())}),e._UZ(23,"i",18),e.qZA()()(),e.TgZ(24,"div",12)(25,"label",13),e._uU(26,"To"),e.qZA(),e.TgZ(27,"div",14),e._UZ(28,"input",19,20),e.TgZ(30,"button",17),e.NdJ("click",function(){e.CHM(i);const g=e.MAs(29);return e.KtG(g.toggle())}),e._UZ(31,"i",18),e.qZA()()(),e.TgZ(32,"div",12)(33,"label",13),e._uU(34,"Notes"),e.qZA(),e._UZ(35,"textarea",21),e.qZA(),e.TgZ(36,"button",22),e._uU(37,"Submit"),e.qZA(),e.TgZ(38,"div",23),e._uU(39,"Cancel"),e.qZA()(),e.YNc(40,O,2,1,"p",24),e.qZA()()()()}2&t&&(e.xp6(13),e.Q6J("formGroup",a.form),e.xp6(1),e.Q6J("ngIf","teacher"!==a.activeUser.user_role),e.xp6(1),e.Q6J("ngIf","teacher"!==a.activeUser.user_role),e.xp6(25),e.Q6J("ngForOf",a.error))},dependencies:[m.sg,m.O5,r.rH,r.yS,d._Y,d.Fj,d.JJ,d.JL,d.sg,d.u,f.w9,f.ir,f.mR,b.J4]}),n})();var L=s(9628);const P=[{path:"",component:E},{path:":id",component:q}];let R=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[m.ez,r.Bz.forChild(P),u.xD,d.u5,d.UX,f.A0,b.M,L.L,b.HK,b.dT]}),n})()}}]);