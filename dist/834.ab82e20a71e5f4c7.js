"use strict";(self.webpackChunknobleui_angular=self.webpackChunknobleui_angular||[]).push([[834],{9632:(v,h,i)=>{i.d(h,{n:()=>e});var _=i(5384),u=i(4650);let e=(()=>{class c extends _.s{getAll(r=""){return this.get(`${this.getUrl()}?${r}`)}find(r){return this.get(`${this.getUrl()}/${r}`)}create(r){return this.post(`${this.getUrl()}`,r)}update(r,p){return this.post(`${this.getUrl()}/${r}`,p)}remove(r){return this.delete(`${this.getUrl()}/${r}`)}}return c.\u0275fac=function(){let m;return function(p){return(m||(m=u.n5z(c)))(p||c)}}(),c.\u0275prov=u.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},5954:(v,h,i)=>{i.d(h,{s:()=>e});var _=i(5384),u=i(4650);let e=(()=>{class c extends _.s{getCompanies(){return this.get("/companies")}getCompany(r){return this.get(`/companies/${r}`)}updateCompany(r,p){return this.post(`/companies/${r}`,p)}createCompany(r){return this.post("/companies",r)}}return c.\u0275fac=function(){let m;return function(p){return(m||(m=u.n5z(c)))(p||c)}}(),c.\u0275prov=u.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},5902:(v,h,i)=>{i.d(h,{O:()=>e});var _=i(5384),u=i(4650);let e=(()=>{class c extends _.s{getTeachers(r=""){return this.get(`/teacher?company_id=${r}`)}getTeacher(r){return this.get(`/teacher/${r}`)}updateTeacher(r,p){return this.post(`/teacher/${r}`,p)}createTeacher(r){return this.post("/teacher",r)}deleteTeacher(r,p){return this.delete(`/teacher/${r}`)}}return c.\u0275fac=function(){let m;return function(p){return(m||(m=u.n5z(c)))(p||c)}}(),c.\u0275prov=u.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},7834:(v,h,i)=>{i.r(h),i.d(h,{HolidayModule:()=>P});var _=i(6895),u=i(9585),e=i(4650),c=i(9632);let m=(()=>{class n extends c.n{getUrl(){return"/holidays"}accept(t){return this.get(`${this.getUrl()}/${t}/accept`)}reject(t){return this.get(`${this.getUrl()}/${t}/reject`)}revoke(t){return this.get(`${this.getUrl()}/${t}/revoke`)}}return n.\u0275fac=function(){let o;return function(a){return(o||(o=e.n5z(n)))(a||n)}}(),n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var r=i(3599),p=i(5954),y=i(8386),b=i(9061);function T(n,o){if(1&n&&e._uU(0),2&n){const t=o.value;e.AsE(" ",t.name," ",t.surname," ")}}function A(n,o){1&n&&(e.TgZ(0,"ngx-datatable-column",21),e.YNc(1,T,1,2,"ng-template",18),e.qZA())}function x(n,o){if(1&n&&e._uU(0),2&n){const t=o.row,a=e.oxw();e.hij(" ",a.getAbsenceType(t.absence_type)," ")}}function Z(n,o){1&n&&(e.TgZ(0,"button",22),e._UZ(1,"i",23),e.qZA()),2&n&&e.s9C("ngbPopover",o.row.notes)}function C(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().row,l=e.oxw(2);return e.KtG(l.accept(s.id))}),e._uU(1," Accept "),e.qZA()}}function U(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().row,l=e.oxw(2);return e.KtG(l.reject(s.id))}),e._uU(1," Reject "),e.qZA()}}function S(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().row,l=e.oxw(2);return e.KtG(l.revoke(s.id))}),e._uU(1," Revoke "),e.qZA()}}function H(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().row,l=e.oxw(2);return e.KtG(l.onRowClicked(s.id))}),e._uU(1," Edit "),e.qZA()}}function w(n,o){if(1&n&&(e.YNc(0,C,2,0,"button",25),e.YNc(1,U,2,0,"button",25),e.YNc(2,S,2,0,"button",25),e.YNc(3,H,2,0,"button",25)),2&n){const t=o.row;e.Q6J("ngIf","accepted"!==t.status),e.xp6(1),e.Q6J("ngIf","pending"===t.status),e.xp6(1),e.Q6J("ngIf","accepted"===t.status),e.xp6(1),e.Q6J("ngIf","accepted"!==t.status)}}function E(n,o){1&n&&(e.TgZ(0,"ngx-datatable-column",24),e.YNc(1,w,4,4,"ng-template",18),e.qZA()),2&n&&e.Q6J("sortable",!1)}let I=(()=>{class n{constructor(t,a,s,l,g){this.holidayApiService=t,this.router=a,this.activatedRoute=s,this.companyApiService=l,this.userService=g,this.rows=[],this.loadingIndicator=!0,this.reorderable=!0,this.ColumnMode=u.hq,this.absenceTypes=[{id:"holiday",name:"Holiday"},{id:"short_term_medical_leave",name:"Short term medical leave"},{id:"short_term_medical_leave",name:"Short term medical leave"},{id:"work_absence",name:"Work absence"},{id:"unjustified",name:"Unjustified"}]}ngOnInit(){this.user=this.userService.getUser(),this.loadData()}loadData(){this.loadingIndicator=!0,this.holidayApiService.getAll().subscribe(t=>{this.rows=t.data,this.loadingIndicator=!1})}onSelect(t){console.log(t)}accept(t){this.holidayApiService.accept(t).subscribe(a=>{this.loadData()})}reject(t){this.holidayApiService.reject(t).subscribe(a=>{this.loadData()})}revoke(t){this.holidayApiService.revoke(t).subscribe(a=>{this.loadData()})}onRowClicked(t){this.router.navigate([t],{relativeTo:this.activatedRoute})}getAbsenceType(t){let a=this.absenceTypes.filter(s=>s.id===t);return 0===a.length?"":a[0].name}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(m),e.Y36(r.F0),e.Y36(r.gz),e.Y36(p.s),e.Y36(y.K))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-holiday"]],decls:26,vars:7,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","."],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"col-md-12","stretch-card"],[1,"card"],[1,"card-body"],[1,"card-title","d-flex","justify-content-between"],["routerLink","new","tabindex","-1","role","button",1,"btn","btn-primary"],[1,"table-responsive"],["rowHeight","auto",1,"bootstrap",3,"rows","loadingIndicator","columnMode","footerHeight","limit"],["name","Teacher","prop","teacher",4,"ngIf"],["name","Date start","prop","start_date"],["name","Date end","prop","end_date"],["name","Status","prop","status"],["name","Absence type","prop","absence_type"],["ngx-datatable-cell-template",""],["name","Information"],["name","Actions","prop","id",3,"sortable",4,"ngIf"],["name","Teacher","prop","teacher"],["type","button","placement","start",1,"btn","btn-primary",3,"ngbPopover"],[1,"feather","icon-info"],["name","Actions","prop","id",3,"sortable"],["class","btn btn-dark mx-1 mb-1",3,"click",4,"ngIf"],[1,"btn","btn-dark","mx-1","mb-1",3,"click"]],template:function(t,a){1&t&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._uU(4,"Holidays"),e.qZA()(),e.TgZ(5,"li",4),e._uU(6,"List"),e.qZA()()(),e.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"h6",9),e._uU(12," Holiday requests "),e.TgZ(13,"a",10),e._uU(14,"New"),e.qZA()(),e.TgZ(15,"div",11)(16,"ngx-datatable",12),e.YNc(17,A,2,0,"ngx-datatable-column",13),e._UZ(18,"ngx-datatable-column",14)(19,"ngx-datatable-column",15)(20,"ngx-datatable-column",16),e.TgZ(21,"ngx-datatable-column",17),e.YNc(22,x,1,1,"ng-template",18),e.qZA(),e.TgZ(23,"ngx-datatable-column",19),e.YNc(24,Z,2,1,"ng-template",18),e.qZA(),e.YNc(25,E,2,1,"ngx-datatable-column",20),e.qZA()()()()()()),2&t&&(e.xp6(16),e.Q6J("rows",a.rows)("loadingIndicator",a.loadingIndicator)("columnMode",a.ColumnMode.force)("footerHeight",50)("limit",10),e.xp6(1),e.Q6J("ngIf","teacher"!==a.user.user_role),e.xp6(8),e.Q6J("ngIf","teacher"!==a.user.user_role))},dependencies:[_.O5,r.yS,u.nE,u.UC,u.vq,b.o8]}),n})();var d=i(433),k=i(5902),Y=i(9646);let D=(()=>{class n{}return n.absenceTypes=[{id:"holiday",name:"Holiday"},{id:"short_term_medical_leave",name:"Short term medical leave"},{id:"short_term_medical_leave",name:"Short term medical leave"},{id:"work_absence",name:"Work absence"},{id:"unjustified",name:"Unjustified"},{id:"other",name:"Other"}],n})(),M=(()=>{class n{get(){return(0,Y.of)(D.absenceTypes)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var f=i(9177);function N(n,o){if(1&n&&e._uU(0),2&n){const t=o.item,a=e.oxw(2);e.hij(" ",a.getUser(t)," ")}}function F(n,o){if(1&n&&(e.TgZ(0,"div",12)(1,"label",13),e._uU(2,"Teacher"),e.qZA(),e.TgZ(3,"ng-select",25),e.YNc(4,N,1,1,"ng-template",26),e.qZA()()),2&n){const t=e.oxw();e.xp6(3),e.Q6J("items",t.teachers)("searchFn",t.customSearchFn)}}function J(n,o){if(1&n&&(e.TgZ(0,"div",12)(1,"label",13),e._uU(2,"Absence type"),e.qZA(),e._UZ(3,"ng-select",27),e.qZA()),2&n){const t=e.oxw();e.xp6(3),e.Q6J("items",t.absenceTypes)}}function O(n,o){if(1&n&&(e.TgZ(0,"p",28),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Oqu(t)}}let $=(()=>{class n{constructor(t,a,s,l,g,j,B,K){this.userService=t,this.teacherApiService=a,this.holidayApiService=s,this.formBuilder=l,this.activatedRoute=g,this.router=j,this.datePipe=B,this.absenceTypesService=K,this.absenceType="",this.teachers=[],this.error=[]}ngOnInit(){this.absenceType="",this.absenceTypesService.get().subscribe(t=>{this.absenceTypes=t}),this.activeUser=this.userService.getUser(),this.teacherApiService.getTeachers().subscribe(t=>{this.teachers=t.data}),this.id=this.activatedRoute.snapshot.paramMap.get("id"),this.form=this.formBuilder.group("teacher"===this.activeUser.user_role?{start_date:["",d.kI.required],end_date:["",d.kI.required],notes:[""]}:{teacher_id:[null,d.kI.required],start_date:["",d.kI.required],end_date:["",d.kI.required],absence_type:["holiday",d.kI.required],notes:[""]}),null!==this.id&&"new"!==this.id&&this.holidayApiService.find(this.id).subscribe(t=>{this.holiday=t.data,this.form.patchValue(t.data),console.log(this.holiday.start_date),this.form.patchValue({start_date:this.stringToDateObject(this.holiday.start_date),end_date:this.stringToDateObject(this.holiday.end_date)})})}onSubmit(){this.error=[];let t=this.form.value;t.start_date=this.getDateString(t.start_date),t.end_date=this.getDateString(t.end_date),"new"===this.id?this.holidayApiService.create(t).subscribe(a=>{this.router.navigate(["/holiday"])},a=>{if(a.errors)for(let s in a.errors)a.errors[s].forEach(l=>{this.error.push(l)});else this.error.push(a.message)}):this.holidayApiService.update(this.id,t).subscribe(a=>{this.router.navigate(["/holiday"])},a=>{if(a.errors)for(let s in a.errors)a.errors[s].forEach(l=>{this.error.push(l)});else this.error.push(a.message)})}getUser(t){return t.name+" "+t.surname}getDateString(t){return`${t.year}-${this.pad(t.month)}-${this.pad(t.day)}`}pad(t,a=2){let s=t+"";for(;s.length<a;)s="0"+s;return s}customSearchFn(t,a){return t=t.toLocaleLowerCase(),a.name.toLocaleLowerCase().indexOf(t)>-1||a.surname.toLocaleLowerCase().indexOf(t)>-1}stringToDateObject(t){return{year:Number(this.datePipe.transform(t,"yyyy")),month:Number(this.datePipe.transform(t,"MM")),day:Number(this.datePipe.transform(t,"dd"))}}addAbsenceType(t){}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(y.K),e.Y36(k.O),e.Y36(m),e.Y36(d.qu),e.Y36(r.gz),e.Y36(r.F0),e.Y36(_.uU),e.Y36(M))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-edit"]],decls:41,vars:4,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","../"],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"col-md-6","grid-margin","stretch-card"],[1,"card"],[1,"card-body"],[1,"card-title"],[1,"forms-sample",3,"formGroup","ngSubmit"],["class","mb-3",4,"ngIf"],[1,"mb-3"],[1,"form-label"],[1,"input-group"],["placeholder","yyyy-mm-dd","formControlName","start_date","ngbDatepicker","",1,"form-control"],["start_date","ngbDatepicker"],["type","button",1,"input-group-text",3,"click"],[1,"feather","icon-calendar","icon-md","text-muted"],["placeholder","yyyy-mm-dd","formControlName","end_date","ngbDatepicker","",1,"form-control"],["end_date","ngbDatepicker"],["id","notes","formControlName","notes","rows","5",1,"form-control"],["type","submit",1,"btn","btn-primary","me-2"],["routerLink","../",1,"btn","btn-secondary","me-2"],["class","text-danger mt-1",4,"ngFor","ngForOf"],["bindValue","id","formControlName","teacher_id",3,"items","searchFn"],["ng-option-tmp","","ng-label-tmp",""],["bindLabel","name","bindValue","id","formControlName","absence_type",3,"items"],[1,"text-danger","mt-1"]],template:function(t,a){if(1&t){const s=e.EpF();e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._uU(4,"Holidays"),e.qZA()(),e.TgZ(5,"li",4),e._uU(6,"New request"),e.qZA()()(),e.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"h6",9),e._uU(12,"Holiday request"),e.qZA(),e.TgZ(13,"form",10),e.NdJ("ngSubmit",function(){return a.onSubmit()}),e.YNc(14,F,5,2,"div",11),e.YNc(15,J,4,1,"div",11),e.TgZ(16,"div",12)(17,"label",13),e._uU(18,"From"),e.qZA(),e.TgZ(19,"div",14),e._UZ(20,"input",15,16),e.TgZ(22,"button",17),e.NdJ("click",function(){e.CHM(s);const g=e.MAs(21);return e.KtG(g.toggle())}),e._UZ(23,"i",18),e.qZA()()(),e.TgZ(24,"div",12)(25,"label",13),e._uU(26,"To"),e.qZA(),e.TgZ(27,"div",14),e._UZ(28,"input",19,20),e.TgZ(30,"button",17),e.NdJ("click",function(){e.CHM(s);const g=e.MAs(29);return e.KtG(g.toggle())}),e._UZ(31,"i",18),e.qZA()()(),e.TgZ(32,"div",12)(33,"label",13),e._uU(34,"Notes"),e.qZA(),e._UZ(35,"textarea",21),e.qZA(),e.TgZ(36,"button",22),e._uU(37,"Submit"),e.qZA(),e.TgZ(38,"div",23),e._uU(39,"Cancel"),e.qZA()(),e.YNc(40,O,2,1,"p",24),e.qZA()()()()}2&t&&(e.xp6(13),e.Q6J("formGroup",a.form),e.xp6(1),e.Q6J("ngIf","teacher"!==a.activeUser.user_role),e.xp6(1),e.Q6J("ngIf","teacher"!==a.activeUser.user_role),e.xp6(25),e.Q6J("ngForOf",a.error))},dependencies:[_.sg,_.O5,r.rH,r.yS,d._Y,d.Fj,d.JJ,d.JL,d.sg,d.u,f.w9,f.ir,f.mR,b.J4]}),n})();var q=i(9628);const L=[{path:"",component:I},{path:":id",component:$}];let P=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[_.ez,r.Bz.forChild(L),u.xD,d.u5,d.UX,f.A0,b.M,q.L,b.HK,b.dT]}),n})()}}]);