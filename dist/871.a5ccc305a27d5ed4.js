"use strict";(self.webpackChunknobleui_angular=self.webpackChunknobleui_angular||[]).push([[871],{5902:(b,g,s)=>{s.d(g,{O:()=>e});var h=s(5384),p=s(4650);let e=(()=>{class m extends h.s{getTeachers(d=""){return this.get(`/teacher?company_id=${d}`)}getTeacher(d){return this.get(`/teacher/${d}`)}updateTeacher(d,a){return this.post(`/teacher/${d}`,a)}createTeacher(d){return this.post("/teacher",d)}deleteTeacher(d,a){return this.delete(`/teacher/${d}`)}}return m.\u0275fac=function(){let u;return function(a){return(u||(u=p.n5z(m)))(a||m)}}(),m.\u0275prov=p.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()},1871:(b,g,s)=>{s.r(g),s.d(g,{TeacherModule:()=>N});var h=s(6895),p=s(9585),e=s(4650),m=s(5902),u=s(3599);let d=(()=>{class o{constructor(t,r,i){this.teacherApiService=t,this.router=r,this.activatedRoute=i,this.rows=[],this.filteredRows=[],this.loadingIndicator=!0,this.reorderable=!0,this.ColumnMode=p.hq}ngOnInit(){this.teacherApiService.getTeachers().subscribe(t=>{this.rows=t.data,this.filteredRows=t.data,this.loadingIndicator=!1})}filter(t){let r=t.target.value.toLowerCase();this.rows=this.filteredRows.filter(i=>-1!==this.getString(i).indexOf(r))}getString(t){let r=`${t.name.toString().toLowerCase()} `;return t.surname&&(r+=`${t.surname.toString().toLowerCase()}`),t.email&&(r+=`${t.email.toString().toLowerCase()}`),r}onRowClicked(t){"click"===t.type&&this.router.navigate([t.row.id],{relativeTo:this.activatedRoute})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(m.O),e.Y36(u.F0),e.Y36(u.gz))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-teacher"]],decls:24,vars:5,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","."],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"col-md-12","stretch-card"],[1,"card"],[1,"card-body"],[1,"card-title","d-flex","justify-content-between"],["routerLink","new","tabindex","-1","role","button",1,"btn","btn-primary"],[1,"col-12"],["type","text",1,"form-control","wd-150",3,"keyup"],[1,"table-responsive"],["rowHeight","auto",1,"bootstrap",3,"rows","loadingIndicator","columnMode","footerHeight","limit","activate"],["name","Name","prop","name"],["name","Surname","prop","surname"],["name","Email","prop","email"],["name","Company","prop","company.name"]],template:function(t,r){1&t&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._uU(4,"Teachers"),e.qZA()(),e.TgZ(5,"li",4),e._uU(6,"List"),e.qZA()()(),e.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"h6",9),e._uU(12," Teachers "),e.TgZ(13,"a",10),e._uU(14,"New"),e.qZA()(),e.TgZ(15,"div",5)(16,"div",11)(17,"input",12),e.NdJ("keyup",function(n){return r.filter(n)}),e.qZA()()(),e.TgZ(18,"div",13)(19,"ngx-datatable",14),e.NdJ("activate",function(n){return r.onRowClicked(n)}),e._UZ(20,"ngx-datatable-column",15)(21,"ngx-datatable-column",16)(22,"ngx-datatable-column",17)(23,"ngx-datatable-column",18),e.qZA()()()()()()),2&t&&(e.xp6(19),e.Q6J("rows",r.rows)("loadingIndicator",r.loadingIndicator)("columnMode",r.ColumnMode.force)("footerHeight",50)("limit",10))},dependencies:[u.yS,p.nE,p.UC]}),o})();var a=s(433),_=s(2851),T=s(5226),Z=s.n(T),C=s(5954),y=s(8386),v=s(9061);function A(o,c){1&o&&e._UZ(0,"input",36),2&o&&e.Q6J("hidden",!0)}function U(o,c){if(1&o&&(e.TgZ(0,"option",39),e._uU(1),e.qZA()),2&o){const t=c.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.name)}}function k(o,c){if(1&o&&(e.TgZ(0,"div",11)(1,"label",18),e._uU(2,"Company"),e.qZA(),e.TgZ(3,"select",37),e.YNc(4,U,2,2,"option",38),e.qZA()()),2&o){const t=e.oxw();e.xp6(4),e.Q6J("ngForOf",t.companies)}}function S(o,c){if(1&o&&(e.TgZ(0,"p",40),e._uU(1),e.qZA()),2&o){const t=c.$implicit;e.xp6(1),e.Oqu(t)}}const q=[{path:"",component:d},{path:":id",component:(()=>{class o{constructor(t,r,i,n,l,f,E){this.router=t,this.activatedRoute=r,this.teacherApiService=i,this.companyApiService=n,this.formBuilder=l,this.userService=f,this.datePipe=E,this.error=[],this.user=null,this.id=null,this.companies=[]}ngOnInit(){this.formGroup=this.formBuilder.group({name:["",a.kI.required],surname:["",a.kI.required],email:["",a.kI.required],user_role:["teacher",a.kI.required],company_id:["",a.kI.required],start_date:[""],leave_date:[""],hours:[31,a.kI.required],start_hours:[null,a.kI.required],colour:["",a.kI.required],text_colour:["",a.kI.required]}),this.activeUser=this.userService.getUser(),"super_admin"!==this.activeUser.user_role&&"admin"!==this.activeUser.user_role&&this.formGroup.patchValue({company_id:this.activeUser.company_id}),this.id=this.activatedRoute.snapshot.paramMap.get("id"),null!==this.id&&"new"!==this.id&&this.teacherApiService.getTeacher(this.id).subscribe(t=>{this.user=t.data,this.formGroup.patchValue(t.data);const r=this.user.start_date;if(r){const n=Number(this.datePipe.transform(r,"yyyy")),l=Number(this.datePipe.transform(r,"MM")),f=Number(this.datePipe.transform(r,"dd"));this.formGroup.controls.start_date.setValue({year:n,month:l,day:f})}const i=this.user.leave_date;if(i){const n=Number(this.datePipe.transform(i,"yyyy")),l=Number(this.datePipe.transform(i,"MM")),f=Number(this.datePipe.transform(i,"dd"));this.formGroup.controls.leave_date.setValue({year:n,month:l,day:f})}this.colour=this.user.colour,this.text_colour=this.user.text_colour}),this.companyApiService.getCompanies().subscribe(t=>{this.companies=[{id:"not_set",name:"All companies"}].concat(t.data)})}delete(){Z().fire({icon:"question",title:"Are you sure?",text:"Are you sure you wish to delete this teacher? Doing so is an irreversible change.",showCancelButton:!0}).then(t=>{t.isConfirmed&&this.onDelete()})}onDelete(){this.user.id&&this.teacherApiService.deleteTeacher(this.user.id,(new Date).toDateString()).subscribe(t=>{this.router.navigate(["/teacher"])})}getDateString(t){return`${t.year}-${this.pad(t.month)}-${this.pad(t.day)}`}pad(t,r=2){let i=t+"";for(;i.length<r;)i="0"+i;return i}onSubmit(){this.error=[];const t={...this.user,...this.formGroup.value};t.start_date&&(t.start_date=this.getDateString(t.start_date)),t.leave_date&&(t.leave_date=this.getDateString(t.leave_date)),"new"!==this.id?this.teacherApiService.updateTeacher(this.user.id,t).subscribe(()=>{this.router.navigate(["/teacher"])},r=>{if(r.errors)for(let i in r.errors)r.errors[i].forEach(n=>{this.error.push(n)});else this.error.push(r.message)}):this.teacherApiService.createTeacher(t).subscribe(()=>{this.router.navigate(["/teacher"])},r=>{if(r.errors)for(let i in r.errors)r.errors[i].forEach(n=>{this.error.push(n)});else this.error.push(r.message)})}onTextColourChange(t){this.formGroup.patchValue({text_colour:t})}onColourChange(t){this.formGroup.patchValue({colour:t})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(u.F0),e.Y36(u.gz),e.Y36(m.O),e.Y36(C.s),e.Y36(a.qu),e.Y36(y.K),e.Y36(h.uU))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-edit"]],decls:67,vars:11,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","../"],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"col-md-6","grid-margin","stretch-card"],[1,"card"],[1,"card-body"],[1,"card-title"],[1,"forms-sample",3,"formGroup","ngSubmit"],[1,"mb-3"],["for","name",1,"form-label"],["type","text","id","name","autocomplete","off","placeholder","Name","formControlName","name",1,"form-control"],["for","surname",1,"form-label"],["type","text","id","surname","autocomplete","off","placeholder","surname","formControlName","surname",1,"form-control"],["for","email",1,"form-label"],["type","text","id","email","autocomplete","off","placeholder","email","formControlName","email",1,"form-control"],["for","company_id",1,"form-label"],[1,"input-group"],["placeholder","yyyy-mm-dd","name","start_date","ngbDatepicker","","formControlName","start_date",1,"form-control"],["start_date","ngbDatepicker"],["type","button",1,"input-group-text",3,"click"],[1,"feather","icon-calendar","icon-md","text-muted"],["placeholder","yyyy-mm-dd","name","leave_date","ngbDatepicker","","formControlName","leave_date",1,"form-control"],["leave_date","ngbDatepicker"],[1,"form-label"],[1,"form-control","wd-150",3,"colorPicker","colorPickerChange"],["type","text","id","start_hours","autocomplete","off","placeholder","Start hours","formControlName","start_hours",1,"form-control"],["type","text","id","hours","autocomplete","off","placeholder","Contract hours","formControlName","hours",1,"form-control"],["class","form-control wd-150","formControlName","company_id",3,"hidden",4,"ngIf"],["class","mb-3",4,"ngIf"],["type","submit",1,"btn","btn-primary","me-2"],["routerLink","../",1,"btn","btn-secondary","me-2"],[1,"btn","btn-danger",3,"click"],["class","text-danger mt-1",4,"ngFor","ngForOf"],["formControlName","company_id",1,"form-control","wd-150",3,"hidden"],["id","company_id","formControlName","company_id",1,"form-select"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"text-danger","mt-1"]],template:function(t,r){if(1&t){const i=e.EpF();e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._uU(4,"Teacher"),e.qZA()(),e.TgZ(5,"li",4),e._uU(6),e.qZA()()(),e.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"h6",9),e._uU(12,"Teacher"),e.qZA(),e.TgZ(13,"form",10),e.NdJ("ngSubmit",function(){return r.onSubmit()}),e.TgZ(14,"div",11)(15,"label",12),e._uU(16,"Name"),e.qZA(),e._UZ(17,"input",13),e.qZA(),e.TgZ(18,"div",11)(19,"label",14),e._uU(20,"Surname"),e.qZA(),e._UZ(21,"input",15),e.qZA(),e.TgZ(22,"div",11)(23,"label",16),e._uU(24,"Email"),e.qZA(),e._UZ(25,"input",17),e.qZA(),e.TgZ(26,"div",11)(27,"label",18),e._uU(28,"Start date"),e.qZA(),e.TgZ(29,"div",19),e._UZ(30,"input",20,21),e.TgZ(32,"button",22),e.NdJ("click",function(){e.CHM(i);const l=e.MAs(31);return e.KtG(l.toggle())}),e._UZ(33,"i",23),e.qZA()()(),e.TgZ(34,"div",11)(35,"label",18),e._uU(36,"Leave date"),e.qZA(),e.TgZ(37,"div",19),e._UZ(38,"input",24,25),e.TgZ(40,"button",22),e.NdJ("click",function(){e.CHM(i);const l=e.MAs(39);return e.KtG(l.toggle())}),e._UZ(41,"i",23),e.qZA()()(),e.TgZ(42,"div",11)(43,"label",26),e._uU(44,"Colour"),e.qZA(),e.TgZ(45,"input",27),e.NdJ("colorPickerChange",function(l){return r.colour=l})("colorPickerChange",function(l){return r.onColourChange(l)}),e.qZA()(),e.TgZ(46,"div",11)(47,"label",26),e._uU(48,"Text colour"),e.qZA(),e.TgZ(49,"input",27),e.NdJ("colorPickerChange",function(l){return r.text_colour=l})("colorPickerChange",function(l){return r.onTextColourChange(l)}),e.qZA()(),e.TgZ(50,"div",11)(51,"label",14),e._uU(52,"Start hours"),e.qZA(),e._UZ(53,"input",28),e.qZA(),e.TgZ(54,"div",11)(55,"label",14),e._uU(56,"Contract hours"),e.qZA(),e._UZ(57,"input",29),e.qZA(),e.YNc(58,A,1,1,"input",30),e.YNc(59,k,5,1,"div",31),e.TgZ(60,"button",32),e._uU(61,"Submit"),e.qZA(),e.TgZ(62,"div",33),e._uU(63,"Cancel"),e.qZA(),e.TgZ(64,"div",34),e.NdJ("click",function(){return r.delete()}),e._uU(65,"Delete user"),e.qZA()(),e.YNc(66,S,2,1,"p",35),e.qZA()()()()}2&t&&(e.xp6(6),e.Oqu(null===r.user?"New":"Edit"),e.xp6(7),e.Q6J("formGroup",r.formGroup),e.xp6(32),e.Udp("background",r.colour),e.Q6J("colorPicker",r.colour),e.xp6(4),e.Udp("background",r.text_colour),e.Q6J("colorPicker",r.text_colour),e.xp6(9),e.Q6J("ngIf","super_admin"!==r.activeUser.user_role&&"admin"!==r.activeUser.user_role),e.xp6(1),e.Q6J("ngIf","super_admin"==r.activeUser.user_role||"admin"),e.xp6(7),e.Q6J("ngForOf",r.error))},dependencies:[h.sg,h.O5,u.rH,u.yS,a._Y,a.YN,a.Kr,a.Fj,a.EJ,a.JJ,a.JL,a.sg,a.u,_.Kk,v.J4]}),o})()}];let N=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[h.ez,u.Bz.forChild(q),p.xD,a.u5,a.UX,_.e4,v.M]}),o})()}}]);